<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Fantasy RPG Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      background: #0f0f0f; /* çok koyu arka plan - göz yormaz */
      overflow: hidden;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    #map {
      height: 100vh;
      width: 100vw;
      background: #1a1a1a; /* koyu arka plan - harita alanı için */
    }

    /* Koyu tema - Zoom butonları ve kontroller */
    .leaflet-control-zoom {
      border: none !important;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5) !important;
    }

    .leaflet-control-zoom a {
      background-color: #2d2d2d !important;
      color: #e0e0e0 !important;
      border: 1px solid #444 !important;
      width: 32px !important;
      height: 32px !important;
      line-height: 32px !important;
      font-size: 18px !important;
      font-weight: bold !important;
      transition: all 0.2s ease !important;
    }

    .leaflet-control-zoom a:hover {
      background-color: #3d3d3d !important;
      color: #ffffff !important;
      border-color: #666 !important;
    }

    .leaflet-control-zoom a:active {
      background-color: #1d1d1d !important;
    }

    .leaflet-control-zoom-in {
      border-bottom: 1px solid #444 !important;
    }

    /* Harita dışındaki boş alanlar için */
    .leaflet-container {
      background: #1a1a1a !important;
    }

    /* Fantasy / RPG popup styling */
    .leaflet-popup-content-wrapper {
      background: radial-gradient(circle at top, #3b2f2f 0%, #1f1b1b 55%, #141010 100%);
      border-radius: 10px;
      border: 2px solid #d4af37; /* gold */
      box-shadow: 0 0 25px rgba(0, 0, 0, 0.7);
      color: #fcefd3;
      font-family: "Georgia", "Times New Roman", serif;
    }

    .leaflet-popup-tip {
      background: #3b2f2f;
      border: 2px solid #d4af37;
    }

    .popup-title {
      font-family: "Cinzel", "IM Fell English", "Georgia", serif;
      font-size: 1.1rem;
      margin: 0 0 0.25rem;
      color: #f8e0a0;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    .popup-description {
      font-size: 0.9rem;
      line-height: 1.4;
      margin: 0;
      color: #fcefd3;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <script>
    // NOTE: These should match the exact pixel dimensions of your map.webp image
    const imageWidth = 7680;  // <- image width in pixels
    const imageHeight = 4320; // <- image height in pixels

    // Define bounds in pixel coordinates: [ [top, left], [bottom, right] ]
    const imageBounds = [[0, 0], [imageHeight, imageWidth]];

    // Create the map with simple CRS (pixel-based coordinates)
    const map = L.map('map', {
      crs: L.CRS.Simple,
      minZoom: -3,   // daha düşük zoom seviyesi - haritanın tamamını görmek için
      maxZoom: 3,
      center: [imageHeight / 2, imageWidth / 2],
      zoom: -2,      // başlangıç zoom seviyesi daha düşük
      zoomSnap: 0.25,
      zoomDelta: 0.5,
      attributionControl: false
    });

    // Add the image as an overlay
    const imageOverlay = L.imageOverlay('map.webp', imageBounds).addTo(map);

    // Image yüklendikten sonra fitBounds yap - haritanın tamamını görmek için
    imageOverlay.on('load', function() {
      map.fitBounds(imageBounds, { padding: [20, 20] });
    });

    // Eğer image zaten yüklüyse (cache'den geliyorsa) hemen fitBounds yap
    if (imageOverlay._image && imageOverlay._image.complete) {
      map.fitBounds(imageBounds, { padding: [20, 20] });
    }

    // Prevent panning completely away from the image
    // Wrap imageBounds with L.latLngBounds so we can use .pad(...)
    map.setMaxBounds(L.latLngBounds(imageBounds).pad(0.5)); // padding biraz artırıldı

    // === Helper: create a city marker (dot) with name + description ===
    // Usage: addCity("Şehir Adı", "Açıklama metni...", y, x);
    function addCity(name, description, y, x) {
      const marker = L.circleMarker([y, x], {
        radius: 7,              // biraz daha büyük nokta
        color: '#ffffff',       // beyaz outline
        weight: 2,              // çok kalın olmayan kenar
        fillColor: '#000000',   // siyah dolgu
        fillOpacity: 0.95
      }).addTo(map);

      marker.bindPopup(`
        <div>
          <h3 class="popup-title">${name}</h3>
          <p class="popup-description">
            ${description}
          </p>
        </div>
      `);

      // Popup'u tıklama yerine hover ile göster
      marker.off('click'); // varsayılan tıklama ile açmayı kaldır
      marker.on('mouseover', function () {
        this.openPopup();
      });
      marker.on('mouseout', function () {
        this.closePopup();
      });

      return marker;
    }

    // === Cities (using [y, x] pixel coordinates) ===
    addCity(
      "Tenkyou",
      "Shogun’un altın surları ve hiç sönmeyen fenerleriyle geceye meydan okuyan, kıtanın atan kalbi. Halk, İmparatorluk Sarayı’nın gölgesinde, kılıçla çizilmiş kusursuz bir sessizlik ve düzen içinde yaşar.",
      2250,
      1770
    );

    addCity(
      "Fuyumori",
      "Başkentin altın sükunetine, demir ve ateşle verilmiş gürültülü bir cevap. Güney Lordu'nun hükmettiği bu şehir, adını üzerine sürekli yağan ve sokaklarını beyaza bürüyen volkanik küllerin yarattığı 'ebedi kış' manzarasından alır.",
      853,
      2131
    );

    addCity(
      "Shinji-Kyo",
      "Binlerce kağıt fenerin soluk ışığında yıkanan, yağmurun ve ipeğin hüküm sürdüğü Doğu'nun ticaret kalbi. Tüccarlar buraya 'İnci' der; çünkü dışı parlak bir zenginlikle kaplıyken, içi karanlık sırlar ve pazarlıklarla doludur.",
      1488,
      6534
    );

    // === Development helper: log pixel coordinates on click ===
    // Logs [y, x] where:
    //   y = vertical pixel coordinate (top = 0, increases downward)
    //   x = horizontal pixel coordinate (left = 0, increases to the right)
    map.on('click', function (e) {
      const y = Math.round(e.latlng.lat);
      const x = Math.round(e.latlng.lng);
      console.log('[y, x] =', [y, x]);
    });
  </script>
</body>
</html>


